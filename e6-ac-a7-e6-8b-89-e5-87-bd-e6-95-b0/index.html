
<!DOCTYPE html>
<html lang="" class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>xuan&#39;s blog</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="xuan,"> 
    
    <meta name="author" content="xuan"> 
    <link rel="alternative" href="atom.xml" title="xuan&#39;s blog" type="application/atom+xml"> 
    <link rel="icon" href="../img/favicon.ico"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="../css/diaspora.css">
</head>
</html>
<body class="loading">
    <div id="loader"></div>
    <div id="single" class="page">
    <div id="top">
        <a class="icon-left image-icon" href="javascript:history.back()"></a>
    </div>
    <div class="section">
        <div class="article">
            <div class="main">
                <div class="content">
                    <p>本页默认宏定义</p>
<p><span class="lang:c++ decode:true  crayon-inline">#define N 100005</span></p>
<p>(\phi(n))表示小于等于(n)的数中与(n)互质的数的数量<br>欧拉定理：</p>
<p><span style="font-family: arial,;">(a^{\phi(p)}\equiv 1 \ (mod \ p)) （(a,p)互质）</span><br><span style="font-family: arial,;">(a^b\equiv a^{b\mod\phi(p)})   ((mod \ p))  （(a,p)互质）</span><br><span style="font-family: arial,;"> (a^x\equiv a^{x\mod\phi(p) \ +\ \phi(p)})  ( (mod \ p) )（(x\geqslant \phi(p)),(a,p)互质）</span><br><span style="font-family: arial,;"> 费马定理：</span></p>
<p><span style="font-family: arial,;">(a^{p-1}\equiv1 \ (mod \ p) )（(p)为质数，且(a)不能被(p)整除）</span><br><span style="font-family: arial,;">(a^b\equiv a^{b\mod(p-1)})   ( (mod \ p)) （(p)为质数，且(a)不能被(p)整除）</span></p>
<p>&nbsp;</p>
<p>线性筛求欧拉函数：</p>
<p>若(n=p_1^{k_1}p_2^{k_2}\cdots p_r^{k_r})</p>
<p>则(\phi \left ( n \right )=n\prod_{p|n}\left ( 1-\frac{1}{p} \right )=n\prod_{p|n}\left ( \frac{p-1}{p} \right ))</p>
<pre class="lang:c++ decode:true" title="euler">int euler[N+10];//phi(n)

void getEuler() {

    memset(euler,0,sizeof(euler));
    euler[1]=1;
    for(int i=2; i&lt;=N; ++i) {
        if(!euler[i]) {
            for(int j=i; j&lt;=N; j+=i) {
                if(!euler[j])
                    euler[j]=j;
                euler[j]=euler[j]/i*(i-1);
            }
        }
    }
}</pre>
求\(n\)的欧拉值：
<pre class="lang:c++ decode:true " title="euler">LL euler(LL n) {
    LL ans = n;
    for(int i = 2; i*i &lt;= n; i++) {
        if(n % i == 0) {
            ans -= ans/i;
            while(n % i == 0)
                n /= i;
        }
    }
    if(n &gt; 1)ans -= ans/n;
    return ans;
}</pre>
&nbsp;

## Example

[HDU 2824 The Euler function](http://acm.hdu.edu.cn/showproblem.php?pid=2824)

题目大意：求\(\sum_{i=a}^{b}\phi \left(i \right)\)

令\(sum\left(n \right)=\sum_{i=1}^{n}\phi \left(n \right)\)，则问题转化为\(sum\left ( b \right )-sum\left ( a-1 \right )\)

可利用线性筛法求出所有\(\phi \left ( n \right )\)
<pre class="lang:c++ decode:true" title="HDU 2824">#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;iostream&gt;
#include&lt;cmath&gt;
#include&lt;cstring&gt;
#include&lt;queue&gt;
using namespace std;
#define N 3000010
#define INF 1&lt;&lt;30
#define LL __int64

LL euler[N+10];

void getEuler(){
    memset(euler,0,sizeof(euler));
    euler[1]=1;
    for(int i=2;i&lt;=N;++i){
        if(!euler[i]){
            for(int j=i;j&lt;=N;j+=i){
                if(!euler[j])
                    euler[j]=j;
                euler[j]=euler[j]/i*(i-1);
            }
        }
    }
}

void getSum(){
    for(int i=3;i&lt;=N;++i){
        euler[i]+=euler[i-1];
    }
}

int main(){
    getEuler();
    getSum();
    int a,b;
    while(scanf("%d%d",&amp;a,&amp;b)!=EOF){
        printf("%I64d\n",euler[b]-euler[a-1]);
    }

    return 0;
}</pre>

<hr>
<p><a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=26&amp;page=show_problem&amp;problem=2421" target="_blank" rel="noopener">uva 11426 GCD - Extreme (II)</a></p>
<p>题意：求(G(n))</p>
<p>[G(n)=\sum_{1\leqslant i&lt; j\leqslant n}\gcd (i,j)]</p>
<p>设(f(n)=\sum_{i=1}^{n-1}\gcd (i,n) )<br>则(G(n)=\sum_{i=2}^{n}f(n))<br>可得递推公式(G(n)=G(n-1)+f(n))<br>所有(\gcd (x, n))的值都是(n)的约数，按照约数进行分类，令(p(n, d))表示满足(\gcd (x, n) = d (x &gt; n) )的正整数(x)的个数，则(f(n)=\sum_{d|n}p(n,d)d)</p>
<p>(\gcd (x, n) = d)的充要条件为(\gcd (\frac{x}{d}, \frac{n}{d}) = 1),因此满足条件的(\frac{x}{d})有(\phi(\frac{n}{d}))个,则(f(n)=\sum_{d|n}\phi(\frac{n}{d})d)</p>
<p>&nbsp;</p>
<p>如果依次计算(f(n))，枚举(f(n))的约数的话效率太低<br>因此对于每个(d)枚举它的倍数(n)并更新(f(n))，时间复杂度(O(n\log (n)))。</p>
<p><pre class="lang:c++ decode:true " title="UVA 11426">#include&lt;cstdio&gt;</pre></p>
<p>#include&lt;algorithm&gt;</p>
<p>#include&lt;iostream&gt;</p>
<p>#include&lt;cmath&gt;</p>
<p>#include&lt;cstring&gt;</p>
<p>#include&lt;queue&gt;<br>using namespace std;</p>
<p>#define N 4000010</p>
<p>#define INF 1&lt;&lt;30</p>
<p>#define LL long long</p>
<p>LL euler[N];<br>LL sum[N];</p>
<p>void getEuler(){<br>    memset(euler,0,sizeof(euler));<br>    euler[1]=1;<br>    for(int i=2;i&lt;=N;++i){<br>        if(!euler[i]){<br>            for(int j=i;j&lt;=N;j+=i){<br>                if(!euler[j]) euler[j]=j;<br>                euler[j]=euler[j]/i*(i-1);<br>            }<br>        }<br>    }<br>}</p>
<p>void getSum(){<br>    for(int i=1;i&lt;=N;++i)<br>        for(int j=i<em>2;j&lt;=N;j+=i)<br>            sum[j]+=euler[j/i]</em>i;<br>    for(int i=3;i&lt;=N;++i)<br>        sum[i]+=sum[i-1];<br>}</p>
<p>int main(){<br>    LL n;<br>    getEuler();<br>    getSum();<br>    while(scanf(“%lld”,&amp;n),n){<br>        printf(“%lld\n”,sum[n]);<br>    }<br>    return 0;<br>}<br>&nbsp;</p>

                </div>
            </div>
        </div>
    </div>
</div>

</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="../js/plugin.js"></script>
<script src="../js/diaspora.js"></script>
<link rel="stylesheet" href="../photoswipe/photoswipe.css">
<link rel="stylesheet" href="../photoswipe/default-skin/default-skin.css">
<script src="../photoswipe/photoswipe.min.js"></script>
<script src="../photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>